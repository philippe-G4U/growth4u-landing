---
import { createSlug } from '../lib/firebase-fetch';

interface CaseItem {
  company: string;
  stat: string;
  label: string;
  highlight: string;
  summary: string;
  challenge: string;
  solution: string;
}

interface Props {
  t: {
    cases: {
      title: string;
      subtitle: string;
      btnRead: string;
      btnHide: string;
      challengeLabel: string;
      solutionLabel: string;
    };
  };
  cases: CaseItem[];
}

const { t, cases } = Astro.props;

const cardGradients = [
  'from-[#6351d5]/5 via-transparent to-[#3f45fe]/5',
  'from-[#0faec1]/5 via-transparent to-[#45b6f7]/5',
  'from-[#f59e0b]/5 via-transparent to-[#fbbf24]/5',
];

const accentColors = ['#6351d5', '#0faec1', '#f59e0b'];

// Icon SVGs for each case (TrendingUp, Shield, Zap)
const caseIconSvgs = [
  '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',
];

const featuredCase = cases[0];
const secondaryCases = cases.slice(1);
---

<section id="casos" class="py-24 bg-gradient-to-b from-slate-50 to-white relative overflow-hidden">
  <!-- Subtle background pattern -->
  <div
    class="absolute inset-0 opacity-[0.015]"
    style="background-image: url(&quot;data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23000000' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E&quot;);"
  ></div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <span class="inline-block px-4 py-1.5 bg-[#6351d5]/10 text-[#6351d5] text-sm font-bold rounded-full mb-4 uppercase tracking-wider">
        Resultados Probados
      </span>
      <h2 class="text-4xl md:text-5xl font-bold mb-4 text-[#032149] tracking-tight">
        {t.cases.title}
      </h2>
      <p class="text-slate-600 text-lg max-w-2xl mx-auto">
        {t.cases.subtitle}
      </p>
    </div>

    <!-- Featured Case (First) -->
    {featuredCase && (
      <div class="mb-8">
        <a
          href={`/casos-de-exito/${createSlug(featuredCase.company)}/`}
          class="group block"
        >
          <div class="bg-white rounded-3xl p-8 md:p-10 relative overflow-hidden border border-slate-200/60 shadow-sm hover:shadow-xl transition-all duration-500 hover:border-[#6351d5]/30">
            <!-- Background gradient -->
            <div class={`absolute inset-0 bg-gradient-to-br ${cardGradients[0]} opacity-0 group-hover:opacity-100 transition-opacity duration-500`}></div>

            <div class="relative grid md:grid-cols-2 gap-8 items-center">
              <!-- Left: Content -->
              <div>
                <div class="flex items-center gap-3 mb-4">
                  <div
                    class="w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300"
                    style={`background-color: ${accentColors[0]}15; color: ${accentColors[0]};`}
                  >
                    <Fragment set:html={caseIconSvgs[0]} />
                  </div>
                  <span class="text-xs font-bold text-slate-500 uppercase tracking-widest">
                    {featuredCase.company}
                  </span>
                </div>

                <div class="mb-4">
                  <span
                    class="text-6xl md:text-7xl font-black tracking-tight"
                    style={`color: ${accentColors[0]};`}
                  >
                    {featuredCase.stat}
                  </span>
                  <span class="block text-xl font-semibold text-[#032149] mt-1">
                    {featuredCase.label}
                  </span>
                </div>

                <p class="text-slate-600 text-lg leading-relaxed mb-6">
                  {featuredCase.summary}
                </p>

                <div class="inline-flex items-center gap-2 text-[#6351d5] font-bold group-hover:gap-3 transition-all duration-300">
                  {t.cases.btnRead}
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                </div>
              </div>

              <!-- Right: Visual highlight box -->
              <div class="bg-slate-50 rounded-2xl p-6 border border-slate-100">
                <div class="space-y-4">
                  <div>
                    <p class="text-xs font-bold text-red-500 uppercase tracking-wider mb-2">
                      {t.cases.challengeLabel}
                    </p>
                    <p class="text-slate-700 leading-relaxed">
                      {featuredCase.challenge}
                    </p>
                  </div>
                  <div class="border-t border-slate-200 pt-4">
                    <p class="text-xs font-bold text-green-600 uppercase tracking-wider mb-2">
                      {t.cases.solutionLabel}
                    </p>
                    <p class="text-slate-700 leading-relaxed">
                      {featuredCase.solution}
                    </p>
                  </div>
                </div>

                {featuredCase.highlight && (
                  <div class="mt-4 pt-4 border-t border-slate-200">
                    <p class="text-sm font-medium text-[#6351d5] italic">
                      &ldquo;{featuredCase.highlight}&rdquo;
                    </p>
                  </div>
                )}
              </div>
            </div>
          </div>
        </a>
      </div>
    )}

    <!-- Secondary Cases (2 columns) -->
    <div class="grid md:grid-cols-2 gap-6">
      {secondaryCases.map((item, i) => {
        const actualIndex = i + 1;
        const slug = createSlug(item.company);
        return (
          <a
            href={`/casos-de-exito/${slug}/`}
            class="group block"
          >
            <div class="bg-white rounded-2xl p-6 md:p-8 relative overflow-hidden border border-slate-200/60 shadow-sm hover:shadow-lg transition-all duration-500 hover:border-slate-300/80 h-full">
              <!-- Background gradient -->
              <div class={`absolute inset-0 bg-gradient-to-br ${cardGradients[actualIndex]} opacity-0 group-hover:opacity-100 transition-opacity duration-500`}></div>

              <div class="relative">
                <!-- Header -->
                <div class="flex items-center justify-between mb-5">
                  <div class="flex items-center gap-3">
                    <div
                      class="w-9 h-9 rounded-xl flex items-center justify-center"
                      style={`background-color: ${accentColors[actualIndex]}15; color: ${accentColors[actualIndex]};`}
                    >
                      <Fragment set:html={caseIconSvgs[actualIndex]} />
                    </div>
                    <span class="text-xs font-bold text-slate-500 uppercase tracking-widest">
                      {item.company}
                    </span>
                  </div>
                </div>

                <!-- Stats -->
                <div class="mb-4">
                  <span
                    class="text-4xl md:text-5xl font-black tracking-tight"
                    style={`color: ${accentColors[actualIndex]};`}
                  >
                    {item.stat}
                  </span>
                  <span class="block text-lg font-semibold text-[#032149] mt-1">
                    {item.label}
                  </span>
                </div>

                <!-- Summary -->
                <p class="text-slate-600 leading-relaxed mb-5 line-clamp-2">
                  {item.summary}
                </p>

                <!-- Highlight teaser -->
                {item.highlight && (
                  <div class="bg-slate-50 rounded-xl p-4 mb-5 border border-slate-100">
                    <p class="text-sm text-slate-700 italic">
                      &ldquo;{item.highlight}&rdquo;
                    </p>
                  </div>
                )}

                <!-- CTA -->
                <div
                  class="inline-flex items-center gap-2 font-bold group-hover:gap-3 transition-all duration-300"
                  style={`color: ${accentColors[actualIndex]};`}
                >
                  {t.cases.btnRead}
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 transition-transform duration-300 group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                </div>
              </div>
            </div>
          </a>
        );
      })}
    </div>

    <!-- CTA to all cases -->
    <div class="text-center mt-14">
      <a
        href="/casos-de-exito/"
        class="group inline-flex items-center gap-3 px-8 py-4 bg-[#032149] hover:bg-[#0a3a6e] text-white font-bold rounded-full transition-all duration-300 shadow-lg hover:shadow-xl"
      >
        Ver todos los casos de Ã©xito
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </a>
    </div>
  </div>
</section>
